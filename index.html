<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <style>body{margin:0;background:#000;overflow:hidden;touch-action:none}canvas{display:block}</style>
</head>
<body>
<script>
const canvas=document.createElement('canvas'),ctx=canvas.getContext('2d');
document.body.appendChild(canvas);
canvas.width=window.innerWidth;canvas.height=window.innerHeight;

let p={x:canvas.width/2,y:canvas.height/2,s:20},en=[],bu=[],sc=0,hi=localStorage.getItem("hi")||0,go=false;

window.addEventListener('touchmove',e=>{if(!go){p.x=e.touches[0].clientX;p.y=e.touches[0].clientY}},{passive:false});

function sp(){if(!go){en.push({x:Math.random()*canvas.width,y:Math.random()<0.5?0:canvas.height,v:0.8+(sc/2000)})}}
setInterval(sp,1000);

setInterval(()=>{if(!go&&en.length>0){let t=en[0],a=Math.atan2(t.y-p.y,t.x-p.x);bu.push({x:p.x,y:p.y,vx:Math.cos(a)*7,vy:Math.sin(a)*7})}},800);

function lo(){
    if(go){
        if(sc>hi){hi=sc;localStorage.setItem("hi",hi)}
        ctx.fillStyle="white";ctx.textAlign="center";ctx.font="30px Arial";
        ctx.fillText("FIM: "+sc,canvas.width/2,canvas.height/2);
        ctx.fillText("BEST: "+hi,canvas.width/2,canvas.height/2+50);
        return;
    }
    ctx.fillStyle="black";ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#0ff";ctx.beginPath();ctx.arc(p.x,p.y,p.s,0,7);ctx.fill();
    
    bu.forEach((b,i)=>{
        b.x+=b.vx;b.y+=b.vy;ctx.fillStyle="#ff0";ctx.fillRect(b.x,b.y,5,5);
        if(b.x<0||b.x>canvas.width||b.y<0||b.y>canvas.height)bu.splice(i,1);
    });

    en.forEach((e,i)=>{
        let dx=p.x-e.x,dy=p.y-e.y,d=Math.hypot(dx,dy);
        e.x+=dx/d*e.v;e.y+=dy/d*e.v;
        ctx.fillStyle="red";ctx.fillRect(e.x-8,e.y-8,16,16);
        if(d<p.s)go=true;
        bu.forEach((b,bi)=>{if(Math.hypot(e.x-b.x,e.y-b.y)<20){en.splice(i,1);bu.splice(bi,1);sc+=10}});
    });
    ctx.fillStyle="#fff";ctx.fillText("Score: "+sc,20,30);
    requestAnimationFrame(lo);
}
window.addEventListener('touchstart',()=>{if(go)location.reload()});
lo();
</script>
</body>
</html>
